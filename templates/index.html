<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>FORMULARIO | HOJA DE VIDA</title>
</head>
<body>
    <nav style="display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; ">
        <div class="imagen">
            <img src="{{url_for('static', filename='image.png')}}" alt="LOGO MTSCFYG" style="width: 250px;">
        </div>
        <div>
            <a href="{{ url_for ('login') }}" style="text-decoration: none; color: #003366; font-weight: bold; padding: 8px 15px; border: 2px solid #003366; border-radius: 5px;">Iniciar Sesión</a>
        </div>
        <button type="button" id="btnReimprimir" style="text-decoration: none; color: #003366; font-weight: bold; padding: 8px 15px; border: 2px solid #003366; border-radius: 5px;">Reimprimir Formulario</button>
    </nav>
    <div style="display: flex; align-items: center; justify-content: center;">
        <label style="font-size: 20px;"><strong>FORMULARIO HOJA DE VIDA</strong></label>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div style="max-width: 1100px; margin: 10px auto;">
                {% for category, message in messages %}
                    <div style="
                    padding: 12px;
                    border-radius: 8px;
                    margin-bottom: 10px;
                    font-weight: bold;
                    background: #d1fae5;
                    color: #065f46;
                    border: 1px solid #10b981;">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>    
        {% endif %}
    {% endwith %}

    <form id="formulario-hv" method="POST" action="{{ url_for('guardar_formulario') }}">
        <div class="container">
            <div class="header">
                I. DATOS PERSONALES
            </div>
            <div class="form-content">
                <div class="form-row">
                    <div class="form-group">
                        <label for="">Nombres:</label>
                        <input type="text" name="nombres" required>
                    </div>
                    <div class="form-group">
                        <label for="">Apellido Paterno:</label>
                        <input type="text" name="ap_pat">
                    </div>
                    <div class="form-group">
                        <label for="">Apellido Materno:</label>
                        <input type="text" name="ap_mat">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="">Cédula de Identidad:</label>
                        <input type="text" name="ci" required>
                    </div>
                    <div class="form-group">
                        <label for="">Expedido en:</label>
                        <select name="exp" required>
                            <option value="">Seleccione...</option>
                            <option value="LP">LP</option>
                            <option value="SC">SC</option>
                            <option value="CB">CB</option>
                            <option value="OR">OR</option>
                            <option value="PT">PT</option>
                            <option value="CH">CH</option>
                            <option value="TJ">TJ</option>
                            <option value="BE">BE</option>
                            <option value="PA">PA</option>
                            <option value="QR">QR</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Estado Civil:</label>
                        <select name="est_civil">
                            <option value="Soltero(a)">Soltero(a)</option>
                            <option value="Casado(a)">Casado(a)</option>
                            <option value="Divorciado(a)">Divorciado(a)</option>
                            <option value="Viudo(a)">Viudo(a)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Fecha de Nacimiento:</label>
                        <input type="date" name="fecha_nac" required>
                    </div>
                    <div class="form-group">
                        <label>Lugar:</label>
                        <input type="text" name="lugar" required>
                    </div>
                    <div class="form-group">
                        <label for="">Nacionalidad</label>
                        <input type="text" name="nacio" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group" style="flex: 2;">
                        <label for="">Dirección/ Domicilio:</label>
                        <input type="text" name="direccion" required>
                    </div>
                    <div class="form-group">
                        <label for="">Ciudad:</label>
                        <input type="text" name="ciudad" required>
                    </div>
                    <div class="form-group">
                        <div class="box">
                            <div>
                                <label for="">Grupo Sanguíneo:</label>
                                <input type="text" name="gr_san" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="">Teléfono Celular:</label>
                        <input type="number" name="tcel" required>
                    </div>
                    <div class="form-group">
                        <label for="">Teléfono Fijo:</label>
                        <input type="number" name="tfijo">
                    </div>
                    <div class="form-group">
                        <label for="">Correo Electrónico:</label>
                        <input type="email" name="correo" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="">N° Libreta de Servicio Militar:</label>
                        <input type="text" name="n_libser">
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="header">II. FORMACIÓN ACADÉMICA</div>
            <div class="form-content">
                <table id="tabla-informacion">
                    <thead>
                        <tr>
                            <th>Detalle (Mencionar el nivel: Estudios Secundarios, Bachiller, Técnico Superior, Técnico Medio, Estudiante Universitario, Profesional, Postgrado)</th>
                            <th>Institución</th>
                            <th>Grado o título obtenido <br>
                                (Titulado o Conclusión de Estudios o En curso)</th>
                            <th>Año</th>
                            <th>N° Folio</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-formacion">
                        <tr class="fila-formacion">
                            <td>
                                <textarea name="detalle[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <textarea name="institucion[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <textarea name="grado[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <input type="number" name="anio[]" style="border: none; width: 100%; padding: 4px;" min="1900" max="2100">
                            </td>
                            <td>
                                <input type="text"
                                name="n_folio[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">III. EXPERIENCIA (Detalle los puestos y instituciones o empresas en las que ejerció funciones, en orden cronológico empezando por la más reciente)</div>
            <div class="form-content">
                <table id="tabla-experiencia">
                    <thead>
                        <tr>
                            <th>Nombre de la Institución o Empresa</th>
                            <th>Puesto</th>
                            <th>Breve descripción de funciones</th>
                            <th>Desde</th>
                            <th>Hasta</th>
                            <th>Motivo de retiro o si trabaja actualmente</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-experiencia">
                        <tr class="fila-experiencia">
                            <td>
                                <textarea name="nombre[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <textarea name="puesto[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <textarea name="breve[]" rows="1" class="auto-resize"></textarea>
                            </td>
                            <td>
                                <input type="date" name="desde[]" class="fecha-experiencia">
                            </td>
                            <td>
                                <input type="date" name="hasta[]" class="fecha-experiencia" >
                            </td>
                            <td>
                                <textarea name="motivo[]" rows="1" class="auto-resize"></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="container">
            <div class="header">IV. CURSOS, SEMINARIOS Y TALLERES DE CAPACITACIÓN (Señale los cursos a los que ha asistido, prioritariamente aquellos relacionados con el cargo al cual postula)</div>
            <div class="form-content">
                <table>
                    <thead>
                        <tr>
                            <th>Año</th>
                            <th>Área de Capacitaciones</th>
                            <th>Institución</th>
                            <th>Nombre de la Capacitación</th>
                            <th>Duración en Horas</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-cursos">
                        <tr class="fila-cursos">
                            <td>
                                <input type="number" name="anio[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                            <td>
                                <textarea type="text" name="cap[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <textarea type="text" name="inst[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <textarea type="text" name="n_cap[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input type="number" name="horas[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">V. MANEJO DE PAQUETES INFORMÁTICOS</div>
            <div class="form-content">
                <table>
                    <thead>
                        <tr>
                            <th>PAQUETE Ms Office</th>
                            <th>REGULAR</th>
                            <th>BUENO</th>
                            <th>MUY BUENO</th>
                            <th>N° Folio</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-paquetes">
                        <tr class="fila-paquetes" data-index="0">
                            <td>
                                <textarea name="paquete[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input type="radio" name="nivel_0" value="regular" style="border: none; padding: 4px; width: 100%; height: 20px;">
                            </td>
                            <td>
                                <input type="radio" name="nivel_0" value="bueno" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input type="radio" name="nivel_0" value="muy_bueno" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input type="text" name="folio_paquete[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                            
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">VI. IDIOMAS</div>
            <div class="form-content">
                <table>
                    <thead>
                        <tr>
                            <th>IDIOMAS</th>
                            <th>Lectura</th>
                            <th>Escritura</th>
                            <th>Conversación</th>
                            <th>N° Folio</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-idiomas">
                        <tr class="fila-idiomas">
                            <td>
                                <textarea name="idioma[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input name="lectura_0" type="checkbox" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input name="escritura_0" type="checkbox" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input name="conversacion_0" type="checkbox" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <textarea name="folio_idioma[]" rows="1" class="auto-resize" type="text" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">VII. DOCENCIA O EXPERIENCIA ACADÉMICA</div>
            <div class="form-content">
                <table>
                    <thead>
                        <tr>
                            <th>Año</th>
                            <th>Institución</th>
                            <th>Nombre del Curso</th>
                            <th>Duración en horas</th>
                            <th>N° Folio</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-docencia">
                        <tr class="fila-docencia">
                            <td>
                                <input type="number" name="anio_docencia[]" style="border: none; width: 100%; padding: 4px;" min="1900" max="2100">
                            </td>
                            <td>
                                <textarea name="institucion_docencia[]" rows="1" class="auto-resize" type="text" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <textarea name="nombre_curso[]" rows="1" class="auto-resize" type="text" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input type="number" name="horas_docencia[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                            <td>
                                <textarea name="folio_docencia[]" rows="1" class="auto-resize" type="text" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">VIII. REFERENCIAS PERSONALES (Señale al menos tres referencias laborales)</div>
            <div class="form-content">
                <table>
                    <thead>
                        <tr>
                            <th>Nombre y Apellido</th>
                            <th>Institución</th>
                            <th>Puesto</th>
                            <th>Teléfono</th>
                        </tr>
                    </thead>
                    <tbody id="tbody-ref">
                        <tr class="fila-ref">
                            <td>
                                <textarea name="nombre_ref[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <textarea name="institucion_ref[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <textarea name="puesto_ref[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input type="text" name="telefono_ref[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="header">IX. REGISTRO PROFESIONAL DEL COLEGIO O ENTIDAD PÚBLICA (Si corresponde):</div>
            <div class="form-content">
                <div class="form-group">
                    <label for="">Nombre:</label>
                    <textarea name="nombre_registro" style="color: #000; width: 100%; padding: 4px;"></textarea>
                    <label style="margin-top: 5px;">N° de Registro</label>
                    <input type="text" name="numero_registro" style="width: 30%; padding: 4px;">
                </div>
            </div>
        </div>
        <div class="container">
            <div class="header">X. PRETENSIÓN SALARIAL:</div>
            <div class="form-content">
                <label for="">Bs:</label>
                <input type="text" name="monto_bs" style="font-size: 15px; width: 50%; padding: 4px;">
            </div>
        </div>
        <div class="container">
            <div class="header">
                XI. DE LAS INCOMPATIBILIDADES O IMPEDIMENTOS
            </div>
            <div class="form-content">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr>
                            <td>PREGUNTA</td>
                            <td>SI</td>
                            <td>NO</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <label><strong>a) ¿Tiene vinculación matrimonial, grado de parentesco hasta el cuarto grado de consanguinidad y segundo de afinidad con algún miembro del Ministerio de Turismo Sostenible, Culturas, Folklore y Gastronomía?.</label></strong></label>
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg1" value="si" style="border: none; width: 80%; height: 20px;">
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg1" value="no" style="border: none; width: 80%; height: 20px;">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label><strong>b) ¿Tiene otra actividad pública remunerada a tiempo completo; actividad privada, directiva sindical, civica, corporativa o gremial, con remuneración o sin ella? (se exceptua la actividad docente universitaria).</label></strong></label>
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg2" value="si" style="border: none; width: 80%; height: 20px;">
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg2" value="no" style="border: none; width: 80%; height: 20px;">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label><strong>c) ¿Percibe renta de vejez u de otro tipo, sin resolución que suspenda legalmente la percepción de dichas rentas?</label></strong></label>
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg3" value="si" style="border: none; width: 80%; height: 20px;">
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg3" value="no" style="border: none; width: 80%; height: 20px;">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label><strong>d) ¿Fue destituido mediante proceso administrativo de alguno de los Organos del Estado; tiene pliego de cargo ejecutoriado o sentencia judicial por responsabilidad civil contra el Estado; o, existe en su contra Sentencia Condenatoria Ejecutoriada a pena privativa de libertad?</label></strong></label>
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg4" value="si" style="border: none; width: 80%; height: 20px;">
                            </td>
                            <td style="text-align: center;">
                                <input type="radio" name="prg4" value="no" style="border: none; width: 80%; height: 20px;">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="container">
            <div class="form-content">
                <label style="font-size: 20px;"><b><i>Declaración Jurada</i></b></label>
                <p><i>Por lo expuesto declaro: <br>
                    Que toda la información expuesta en el presente formulario es verdadera y que la documentación presentada como respaldo es fidedigna.
                    
                    Si el Ministerio de Turismo Sostenible, Culturas y Folklore y Gastronomía  evidencia falsedad en la información, se procederá de acuerdo a Ley.</i></p><br><br>
                    <p style="display: flex; text-align: center; justify-content: center; font-size: 15px;">.................................... <br> Firma </p>
                    <label for="">Lugar:</label>
                    <input type="text" name="lugar_declaracion">
                    <label for="">Fecha:</label>
                    <input type="date" name="fecha_declaracion">
            </div>
        </div>
        <div>
            <button id="btn-guardar" type="button"
                style="text-decoration: none; color: #003366; font-weight: bold; padding: 8px 15px; border: 2px solid #003366; border-radius: 5px; display: flex; text-align: center; justify-content: center;">
                GUARDAR
            </button>
        </div>

    </form>

    <div class="modal" id="modalReimprimir">
        <div class="modal-content">
            <h3>Reimprimir Formulario</h3>
            <p>Ingresa el correo del formulario:</p>
            <form method="POST" action="{{ url_for('reimprimir') }}">
                <input type="email" name="correo" placeholder="adri@gmail.com" required>
                <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:15px;">
                    <button type="button" id="btnCerrarModal" style="text-decoration: none; color: #003366; font-weight: bold; padding: 8px 15px; border: 2px solid #003366; border-radius: 5px;">Cancelar</button>
                    <button type="submit" style="text-decoration: none; color: #003366; font-weight: bold; padding: 8px 15px; border: 2px solid #003366; border-radius: 5px;">Aceptar</button>
                </div>
            </form>
        </div>
    </div>


    <style>
        body{
            font-family: Arial, Helvetica, sans-serif;
            padding: 20px;
        }
        .container{
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border: 2px solid;
            margin-top: 20px;
        }
        .header{
            background-color: #003366;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            font-size: 18px;
        }
        .form-content{
            padding: 20px;
        }
        .form-row{
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-start;
        }
        .form-group{
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        label{
            font-size: 12px;
            margin-bottom: 5px;
            color: #333;
        }
        input[type="text"], input[type="date"], input[type="email"], input[type="number"]{
            padding: 6px;
            border: 1px solid #000;
            font-size: 12px;
            width: 100%;
            box-sizing: border-box;
        }
        table{
            width: 100%;
            border-collapse: collapse;
        }
        thead{
            background-color: #003366;
            color: white;
        }
        th{
            border: 1px solid #003366;
            padding: 10px;
            font-size: 11px;
            text-align: center;
            width: 200px;
        }
        td{
            border: 1px solid #000;
            padding: 8px;
        }
        textarea{
            border: none;
            width: 100%;
            padding: 4px;
            resize: none;
            overflow: hidden;
            font-family: inherit;
            font-size: inherit;
        }
        .modal {
    display: none;
    position: fixed;
    z-index: 999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    }

    .modal-content {
        background: white;
        width: 90%;
        max-width: 400px;
        margin: 10% auto;
        padding: 20px;
        border-radius: 12px;
    }

    .modal-content input {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
    }

    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function(){
            const tbody = document.getElementById('tbody-formacion');

            function autoResize(textarea){
                textarea.style.height = 'auto';
                textarea.style.height = textarea.scrollHeight + 'px';
            }

            function isRowComplete(row){
                const inputs = row.querySelectorAll('input, textarea');
                let completed = true;
                inputs.forEach(input => {
                    if(input.value.trim() === ''){
                        completed = false;
                    }
                });
                return completed;
            }

            function addRowEvents(row, tbody, createRowFunction){
                const textareas = row.querySelectorAll('.auto-resize');
                const allInputs = row.querySelectorAll('input, textarea');

                textareas.forEach(textarea => {
                    textarea.addEventListener('input', function(){
                        autoResize(this);
                    });
                });

                allInputs.forEach(input => {
                    input.addEventListener('input', function(){
                        const currentRow = this.closest('tr');
                        const isLastRow = currentRow === tbody.lastElementChild;

                        if (isLastRow && isRowComplete(currentRow)){
                            const newRow = createRowFunction();
                            tbody.appendChild(newRow);
                            addRowEvents(newRow, tbody, createRowFunction);
                        }
                    });
                });
            }

            const tbodyFormacion = document.getElementById('tbody-formacion');

            function createNewRowFormacion(){
                const newRow = document.createElement('tr');
                newRow.className = 'fila-formacion';
                newRow.innerHTML = `
                    <td>
                        <textarea class="auto-resize" name="detalle[]" rows="1" style="border: none; width: 100%; padding: 4px; resize: none; overflow: hidden; font-family: inherit; font-size: inherit;"></textarea>
                    </td>
                    <td>
                        <textarea class="auto-resize" name="institucion[]" rows="1" style="border: none; width: 100%; padding: 4px; resize: none; overflow: hidden; font-family: inherit; font-size: inherit;"></textarea>
                    </td>
                    <td>
                        <textarea class="auto-resize" name="grado[]" rows="1" style="border: none; width: 100%; padding: 4px; resize: none; overflow: hidden; font-family: inherit; font-size: inherit;"></textarea>
                    </td>
                    <td>
                        <input type="number" name="anio[]" style="border: none; width: 100%; padding: 4px;" min="1900" max="2100">
                    </td>
                    <td>
                        <input type="text" name="n_folio[]" style="border: none; width: 100%; padding: 4px;">
                    </td>
                `;
                return newRow;
            }

            const tbodyCursos = document.getElementById('tbody-cursos');

            function createNewRowCursos(){
                const newRow = document.createElement('tr');
                newRow.className = 'fila-cursos';
                newRow.innerHTML = `
                        <td>
                            <input type="number" name="anio[]" style="border: none; width: 100%; padding: 4px;">
                        </td>
                        <td>
                            <textarea type="text" name="cap[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <textarea type="text" name="inst[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <textarea type="text" name="n_cap[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <input type="number" name="horas[]" style="border: none; width: 100%; padding: 4px;">
                        </td>
                `;
                return newRow;

            }
            const firstRowFormacion = tbodyFormacion.querySelector('.fila-formacion');
            if(firstRowFormacion){
                addRowEvents(firstRowFormacion, tbodyFormacion, createNewRowFormacion)
            }
            
            const tbodyExperiencia = document.getElementById('tbody-experiencia');

            function createNewRowExperiencia(){
                const newRow = document.createElement('tr');
                newRow.className = 'fila-experiencia';
                newRow.innerHTML = `
                    <td>
                        <textarea name="nombre[]" rows="1" class="auto-resize"></textarea>
                    </td>
                    <td>
                        <textarea name="puesto[]" rows="1" class="auto-resize"></textarea>
                    </td>
                    <td>
                        <textarea name="breve[]" rows="1" class="auto-resize"></textarea>
                    </td>
                    <td>
                        <input type="date" name="desde[]">
                    </td>
                    <td>
                        <input type="date" name="hasta[]">
                    </td>
                    <td>
                        <textarea name="motivo[]" rows="1" class="auto-resize"></textarea>
                    </td>
                `;
                return newRow;
            }

            const tbodyPaquetes = document.getElementById('tbody-paquetes');

            function createNewRowPaquetes(){
                const newRow = document.createElement('tr');
                newRow.className = 'fila-paquetes';
                newRow.dataset.index = index;

                newRow.innerHTML = `
                        <td>
                                <textarea name="paquete[]" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                            </td>
                            <td>
                                <input type="radio" name="nivel_${index}" value="regular" style="border: none; padding: 4px; width: 100%; height: 20px;">
                            </td>
                            <td>
                                <input type="radio" name="nivel_${index}" value="bueno" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input type="radio" name="nivel_${index}" value="muy_bueno" style="border: none; width: 100%; padding: 4px; height: 20px;">
                            </td>
                            <td>
                                <input type="text" name="folio_paquete[]" style="border: none; width: 100%; padding: 4px;">
                            </td>
                `;
                return newRow;
            }

            const tbodyIdiomas = document.getElementById('tbody-idiomas');

            function createNewRowIdiomas(){
            const index = tbodyIdiomas.querySelectorAll('tr.fila-idiomas').length;

            const newRow = document.createElement('tr');
            newRow.className = 'fila-idiomas';
            newRow.dataset.index = index;

            newRow.innerHTML = `
                <td>
                <textarea name="idioma[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                </td>
                <td style="text-align:center;">
                <input name="lectura_${index}" type="checkbox" style="height: 20px;">
                </td>
                <td style="text-align:center;">
                <input name="escritura_${index}" type="checkbox" style="height: 20px;">
                </td>
                <td style="text-align:center;">
                <input name="conversacion_${index}" type="checkbox" style="height: 20px;">
                </td>
                <td>
                <textarea name="folio_idioma[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                </td>
            `;

            return newRow;
            }


            const tbodyDocencia = document.getElementById('tbody-docencia');

            function createNewRowDocencia(){
            const newRow = document.createElement('tr');
            newRow.className = 'fila-docencia';

            newRow.innerHTML = `
                <td>
                <input type="number" name="anio_docencia[]" style="border: none; width: 100%; padding: 4px;" min="1900" max="2100">
                </td>
                <td>
                <textarea name="institucion_docencia[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                </td>
                <td>
                <textarea name="nombre_curso[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                </td>
                <td>
                <input type="number" name="horas_docencia[]" style="border: none; width: 100%; padding: 4px;">
                </td>
                <td>
                <textarea name="folio_docencia[]" rows="1" class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                </td>
            `;

            return newRow;
            }

            const tbodyRef = document.getElementById('tbody-ref');

            function createNewRowRef(){
                const newRow = document.createElement('tr');
                newRow.className = 'fila-ref';
                newRow.innerHTML = `
                        <td>
                            <textarea class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <textarea class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <textarea class="auto-resize" style="border: none; width: 100%; padding: 4px;"></textarea>
                        </td>
                        <td>
                            <input type="text" style="border: none; width: 100%; padding: 4px;">
                        </td>
                `;
                return newRow;
            }

            //años
            function calcularAnios(){
                const filas = tbodyExperiencia.querySelectorAll('.fila-experiencia');
                let totalMeses = 0;

                filas.forEach(fila => {
                    const inputDesde = fila.querySelector('input[name="desde[]"]');
                    const inputHasta = fila.querySelector('input[name="hasta[]"]');

                    if (!inputDesde || !inputHasta) return;

                    const desde = inputDesde.value;
                    const hasta = inputHasta.value;

                    if (desde && hasta){
                        const fechaDesde = new Date(desde);
                        const fechaHasta = new Date(hasta);

                        if(fechaHasta >= fechaDesde){
                            // cálculo por meses (más exacto)
                            let meses = (fechaHasta.getFullYear() - fechaDesde.getFullYear()) * 12;
                            meses += (fechaHasta.getMonth() - fechaDesde.getMonth());

                            // si el día final es menor al inicial, resta 1 mes
                            if (fechaHasta.getDate() < fechaDesde.getDate()) {
                                meses -= 1;
                            }

                            totalMeses += meses;
                        }
                    }
                });

                const anios = Math.floor(totalMeses / 12);
                const meses = totalMeses % 12;

                document.getElementById('total-anios').value = anios;
                document.getElementById('total-meses').value = meses;
            }


            function addRowEventsExperiencia(row){
                addRowEvents(row, tbodyExperiencia, createNewRowExperiencia);

                const fechas = row.querySelectorAll('input[name="desde[]"], input[name="hasta[]"]');
                fechas.forEach(fecha => {
                    fecha.addEventListener('change', function(){
                        calcularAnios();
                    });
                    fecha.addEventListener('input', function(){
                        calcularAnios();
                    });
                });
            }

        const btn = document.getElementById("btn-calcular");
        if (btn) {
            btn.addEventListener("click", calcularAnios);
        }
            
            const firstRowExperiencia = tbodyExperiencia.querySelector('.fila-experiencia');
            if(firstRowExperiencia){
                addRowEventsExperiencia(firstRowExperiencia);
            }

            const firstRowCursos = tbodyCursos.querySelector('.fila-cursos');
            if(firstRowCursos){
                addRowEvents(firstRowCursos, tbodyCursos, createNewRowCursos);
            }

            const firstRowPaquetes = tbodyPaquetes.querySelector('.fila-paquetes');
            if(firstRowPaquetes){
                addRowEvents(firstRowPaquetes, tbodyPaquetes, createNewRowPaquetes);
            }

            const firstRowIdiomas = tbodyIdiomas.querySelector('.fila-idiomas');
            if(firstRowIdiomas){
                addRowEvents(firstRowIdiomas, tbodyIdiomas, createNewRowIdiomas);
            }

            const firstRowDocencia = tbodyDocencia.querySelector('.fila-docencia');
            if(firstRowDocencia){
                addRowEvents(firstRowDocencia, tbodyDocencia, createNewRowDocencia);
            }

            const firstRowRef = tbodyRef.querySelector('.fila-ref');
            if(firstRowRef){
                addRowEvents(firstRowRef, tbodyRef, createNewRowRef);
            }

        });

        const btnReimprimir = document.getElementById("btnReimprimir");
        const modal = document.getElementById("modalReimprimir");
        const btnCerrar = document.getElementById("btnCerrarModal");

        btnReimprimir.addEventListener("click", () => {
            modal.style.display = "block";
        });

        btnCerrar.addEventListener("click", () => {
            modal.style.display = "none";
        });

        window.addEventListener("click", (e) => {
            if (e.target === modal) {
                modal.style.display = "none";
            }
        });

        document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("formulario-hv");
        const btnGuardar = document.getElementById("btn-guardar");

        btnGuardar.addEventListener("click", () => {
            const ok = confirm("¿Estás segura de guardar los datos y descargar el PDF?");

            if (!ok) {
            // Si presiona NO -> se queda en el formulario
            return;
            }
            // Si presiona SÍ -> se envía el formulario (se guarda y descarga PDF)
            form.submit();
        });
        });
    </script>
</body>
</html>